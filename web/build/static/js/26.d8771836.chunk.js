(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[26],{1255:function(e,t,n){"use strict";n.r(t);var c,a,r,i,o=n(334),d=n(31),s=n(16),l=n(24),u=n(335),b=n(49),j=n(323),O=n.n(j),p=n(939),f=n(0),m=n(507),h=n(1237),v=n(720),y=n.n(v),x=n(1),C=Object(h.a)({root:{background:"linear-gradient(#0000cc, #000080)",color:"white",borderRadius:0,fontWeight:600,border:"5px solid",borderColor:"white",padding:"5px 25px",textTransform:"uppercase","&:hover":{background:"linear-gradient(#000080, #0000cc)"},"&:disabled":{cursor:"not-allowed"}}}),g=function(e){var t=C();return Object(x.jsx)(m.a,Object(l.a)(Object(l.a)({variant:"contained",className:t.root,startIcon:Object(x.jsx)(y.a,{})},e),{},{fullWidth:!0,children:e.label}))},S=n(67),I=n(715),k=n(750),N=n(785),w=n(112),q=n(304),T=n(308),$=n(22),B=["sx"],P=Object(S.d)(c||(c=Object(b.a)(["\n    query GetProjectTitle($id: Int!) {\n        orderheader(id: $id) {\n            projectTitle\n        }\n    }\n"]))),A=Object(S.d)(a||(a=Object(b.a)(["\n    query getActivityInfo($codes: [String!]) {\n        ratesetPrices(filter: {activitycode: {activityCode: {in: $codes}}}) {\n            nodes {\n                activitycodeId\n                ratesetHeaderId\n                id\n                unitBaseLabour\n                unitBaseOther\n                activitycode {\n                    activityCode\n                }\n            }\n            totalCount\n        }\n    }\n"]))),W=Object(S.d)(r||(r=Object(b.a)(["\n    mutation CreateLocationWithDetail($input:  CreateSitelocationInput!) {\n        createSitelocation(\n            input: $input\n        ) {\n            sitelocation {\n                id\n                reference\n                orderdetailWithValues {\n                    nodes {\n                        activityCode\n                        activityDescription\n                        complete\n                        id\n                        itemNumber\n                        locationReference\n                        orderNumber\n                        projectTitle\n                        qtyApplied\n                        qtyComplete\n                        qtyOrdered\n                        qtyOs\n                        valueApplied\n                        valueComplete\n                        valueOs\n                        valuePayableTotal\n                        worksheetReference\n                    }\n                }\n            }\n        }\n    }\n"]))),E=Object(S.d)(i||(i=Object(b.a)(["\n    query CheckActivitycodeExists($codes: [String!]) {\n        activitycodes(filter: {activityCode: {in: $codes}}) {\n            nodes {\n                id\n                activityCode\n            }\n            totalCount\n        }\n    }\n"])));function M(e){var t=e.sx,n=Object(u.a)(e,B);return Object(x.jsx)(q.a,Object(l.a)({sx:Object(l.a)({textAlign:"center"},t)},n))}t.default=function(){var e=Object(f.useState)(void 0),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(f.useState)([]),r=Object(s.a)(a,2),i=r[0],l=r[1],u=Object(f.useState)([]),b=Object(s.a)(u,2),j=b[0],m=b[1],h=Object(f.useState)([]),v=Object(s.a)(h,2),y=v[0],C=v[1],S=Object(f.useState)([]),B=Object(s.a)(S,2),z=B[0],D=B[1],L=Object(f.useState)(!1),R=Object(s.a)(L,2),F=R[0],H=R[1],J=Object(f.useState)(1),G=Object(s.a)(J,2),U=G[0],V=G[1],K=Object($.f)(),Q=Object(I.a)(P,{variables:{id:Object(w.b)().selectedOrder.id}}).data,X=Object(k.a)(A,{onCompleted:function(e){!function(e){var t=i.map((function(t){var n=e.ratesetPrices.nodes.filter((function(e){return e.activitycode.activityCode===t.code&&e.ratesetHeaderId===t.ratesetId}));return{reference:t.reference,itemNumber:t.itemNumber,qtyOrdered:t.qtyOrdered,itemTypeId:t.itemTypeId,packNumber:t.packNumber,valueBaseMaterials:t.valueBaseMaterials,ratesetPriceId:n.map((function(e){return e.id}))[0]}}));l(t)}(e)}}),Y=Object(s.a)(X,1)[0],Z=Object(N.a)(W,{notifyOnNetworkStatusChange:!1,onCompleted:function(){V((function(e){return e+1})),j.length===U&&K.push("/projects")}}),_=Object(s.a)(Z,2),ee=_[0],te=_[1],ne=te.loading,ce=te.networkStatus,ae=Object(k.a)(E,{onCompleted:function(e){H(e.activitycodes.totalCount===z.length),Y({variables:{codes:z}})}}),re=Object(s.a)(ae,1)[0];function ie(){return(ie=Object(o.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.forEach((function(e){ee({variables:{input:e}})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return ne||1===ce?Object(x.jsx)(T.a,{color:"secondary",size:300,sx:{p:25}}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{style:{margin:10,fontWeight:"bold",fontSize:20},children:Q&&Q.orderheader.projectTitle}),Object(x.jsxs)(q.a,{sx:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",mb:2},children:[Object(x.jsxs)(M,{children:[Object(x.jsx)("input",{type:"file",accept:".xlsx",onChange:function(e){var t=e.target.files[0];Object(p.c)(t).then((function(e){return c(e)})).catch((function(e){return console.error(e)}))},id:"upload",style:{display:"none"}}),Object(x.jsx)("label",{htmlFor:"upload",children:Object(x.jsx)(g,{label:"select file",disabled:void 0!==n,onClick:function(){return document.getElementById("upload").click()}})})]}),Object(x.jsx)(M,{children:Object(x.jsx)(g,{onClick:function(){l(Object(p.b)(y));var e=Object(d.a)(new Set(Object(p.b)(y).map((function(e){return e.code})))),t=Array.from(e);D(t),re({variables:{codes:t}})},label:"verify data",disabled:void 0===n||F})}),Object(x.jsx)(M,{children:Object(x.jsx)(g,{label:"compile data",disabled:!F||j.length>0,onClick:function(){var e=Object(d.a)(new Set(i.map((function(e){return e.reference})))).map((function(e){return{sitelocation:{reference:e,orderheaderId:Object(w.b)().selectedOrder.id,orderdetails:{create:i.filter((function(t){return t.reference===e})).map((function(e){return{orderheaderId:Object(w.b)().selectedOrder.id,itemNumber:e.itemNumber,ratesetPriceId:e.ratesetPriceId,itemTypeId:e.itemTypeId,packNumber:String(e.packNumber),valueBaseMaterials:e.valueBaseMaterials,qtyOrdered:e.qtyOrdered}}))}}}}));m(e)}})}),Object(x.jsx)(M,{children:Object(x.jsx)(g,{label:"submit data",disabled:!n||0===j.length,onClick:function(){return ie.apply(this,arguments)}})})]}),Object(x.jsxs)(q.a,{display:"flex",justifyContent:"space-between",ml:5,mr:5,fontWeight:"bold",fontSize:20,children:[Object(x.jsx)("div",{children:"Item Count ".concat(i.length)}),Object(x.jsx)("div",{children:"Location Count ".concat(j.length)})]}),Object(x.jsx)(p.a,{initialData:n,onSheetUpdate:function(e){return C(e)},activeSheetClassName:"active-sheet",reactExcelClassName:"react-excel"})]})}},836:function(e,t){},942:function(e,t){},943:function(e,t){}}]);
//# sourceMappingURL=26.d8771836.chunk.js.map